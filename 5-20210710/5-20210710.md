# day5日报

## 今天工作安排
1. 上午
- 每日例会
2. 下午
- 周例会
3. 墨子号接入华为云/BC26 LwM2M 华为云
4. 项目的文档该开始写了

---
## 今日参考文档

0、墨子号的接入手册
博客
1、BC95 MQTT接入
https://bbs.huaweicloud.com/blogs/249333

2、BC95 lwm2m接入
https://bbs.huaweicloud.com/blogs/249241

3、论坛 看上去比较靠谱
https://bbs.huaweicloud.com/forum/thread-24479-1-1.html

4、墨子号的源码


5、小熊派
https://support.huaweicloud.com/bestpractice-iothub/iot_bp_0007.html

---
## BC26模块使用LwM2M协议接入华为IoT平台

![20210710_140701_62](images/20210710_140701_62.png)

![20210710_140903_26](images/20210710_140903_26.png)

![20210710_140935_71](images/20210710_140935_71.png)

![20210710_141130_25](images/20210710_141130_25.png)

![20210710_141227_96](images/20210710_141227_96.png)

![20210710_144609_74](images/20210710_144609_74.png)

![20210710_141256_13](images/20210710_141256_13.png)

![20210710_141323_05](images/20210710_141323_05.png)

![20210710_141419_17](images/20210710_141419_17.png)

![20210710_141531_98](images/20210710_141531_98.png)

![20210710_141829_93](images/20210710_141829_93.png)

![20210710_142246_28](images/20210710_142246_28.png)

![20210710_142350_86](images/20210710_142350_86.png)

![20210710_142456_87](images/20210710_142456_87.png)

![20210710_142600_22](images/20210710_142600_22.png)

![20210710_144347_85](images/20210710_144347_85.png)

## today
- 整理单片机&传感器
- 一些之前写过的文档
    - 先写内容再整理格式
- keil环境
    - stm32g0/F1/F4?
    - cube
    - hal
    - jtag/uart？
---

## STM32相关环境配置与使用

### 1. MDK与Keil破解
因为之前做过电子设计竞赛使用过同是ARM内核的TI的板卡(TM4C123GH6PM、TM4C1294)、以及进行过简单的STM32F10x的开发项目，所以环境大部分是配好的。

### 2. STM32G0 dfp pack安装

![20210710_180415_42](images/20210710_180415_42.png)

双击安装包即可安装。

### 3. STM32CubeMX的安装

![20210710_180513_11](images/20210710_180513_11.png)

双击安装包即可安装。

### 4. STM32CubeMx使用

STM32Cubemx是一个图形工具，允许STM32微控制器和微处理器的非常简单的配置，以及ARM®Cortex®的ARM®Cortex-M核心或部分Linux®设备树的相应初始化C代码的生成 通过逐步处理核心）。

![20210710_180913_34](images/20210710_180913_34.png)

![20210710_181524_95](images/20210710_181524_95.png)

![20210710_181611_86](images/20210710_181611_86.png)

![20210710_181726_74](images/20210710_181726_74.png)

![20210710_181838_25](images/20210710_181838_25.png)

![20210710_181951_65](images/20210710_181951_65.png)

![20210710_182046_13](images/20210710_182046_13.png)

![20210710_182137_66](images/20210710_182137_66.png)

![20210710_182237_91](images/20210710_182237_91.png)

![20210710_182416_56](images/20210710_182416_56.png)

![20210710_182633_16](images/20210710_182633_16.png)

这里如果电脑中之前写过Java代码/配置过高级别jre/配置过高级别jdk，会出现一个奇怪的问题：
**stm32cubemx the code is successfully generated under but MDK-ARM V5 Project**

代码生成成功，但是MDK project启动文件生成有错误。（类似于下图的弹窗）。

![20210710_182813_74](images/20210710_182813_74.png)

这就是由于java版本过高导致的编译错误。

![20210710_183406_53](images/20210710_183406_53.png)

解决方案有两种：
1. 在电脑中卸载掉所有的jre和jdk后，更换成**低版本jre**；
2. 可以使用生成其他IDE之后在keil中的同路径下建立新的工程。

解决后，即可直接选择Open Project，即可打开keil工程。

编译后，由于STM32G0板卡上没有jtag预留口，且jtag手动插线比较繁琐，所以使用uart连接后再烧录上板。这时就要用到STM32CubeProgrammer。

### 5. STM32CubeProgrammer的安装与使用

同样的，直接双击安装包即可安装`STM32CubeProgrammer`。

![20210710_184040_91](images/20210710_184040_91.png)

最后点击connect，可以连接上板卡。

![20210710_184327_53](images/20210710_184327_53.png)

按照以下步骤配置：

![20210710_184358_69](images/20210710_184358_69.png)

![20210710_184612_54](images/20210710_184612_54.png)

![20210710_184721_26](images/20210710_184721_26.png)

---
## 有关于单片机 相关总结
1. uart串口烧录也很麻烦，所以准备使用stm32f10x的板卡，用jtag直接在keil中下载。
2. HAL库开发有待学习。
